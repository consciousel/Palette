{"ast":null,"code":"\"use strict\";\n/**\n * @packageDocumentation\n * @module harmony-crypto\n * @hidden\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.decode = exports.encode = void 0; // this file is ported from https://github.com/ethers-io/ethers.js/blob/master/src.ts/utils/rlp.ts\n// and done some fixes\n\nvar bytes_1 = require(\"./bytes\");\n\nfunction arrayifyInteger(value) {\n  var result = [];\n\n  while (value) {\n    result.unshift(value & 0xff);\n    value >>= 8;\n  }\n\n  return result;\n}\n\nfunction unarrayifyInteger(data, offset, length) {\n  var result = 0;\n\n  for (var i = 0; i < length; i++) {\n    result = result * 256 + data[offset + i];\n  }\n\n  return result;\n}\n\nfunction _encode(object) {\n  if (Array.isArray(object)) {\n    var payload_1 = [];\n    object.forEach(function (child) {\n      payload_1 = payload_1.concat(_encode(child));\n    });\n\n    if (payload_1.length <= 55) {\n      payload_1.unshift(0xc0 + payload_1.length);\n      return payload_1;\n    } // tslint:disable-next-line: no-shadowed-variable\n\n\n    var length_1 = arrayifyInteger(payload_1.length);\n    length_1.unshift(0xf7 + length_1.length);\n    return length_1.concat(payload_1);\n  }\n\n  var data = Array.prototype.slice.call(bytes_1.arrayify(object));\n\n  if (data.length === 1 && data[0] <= 0x7f) {\n    return data;\n  } else if (data.length <= 55) {\n    data.unshift(0x80 + data.length);\n    return data;\n  }\n\n  var length = arrayifyInteger(data.length);\n  length.unshift(0xb7 + length.length);\n  return length.concat(data);\n}\n\nfunction encode(object) {\n  return bytes_1.hexlify(_encode(object));\n}\n\nexports.encode = encode;\n\nfunction _decodeChildren(data, offset, childOffset, length) {\n  var result = [];\n\n  while (childOffset < offset + 1 + length) {\n    var decoded = _decode(data, childOffset);\n\n    result.push(decoded.result);\n    childOffset += decoded.consumed;\n\n    if (childOffset > offset + 1 + length) {\n      throw new Error('invalid rlp');\n    }\n  }\n\n  return {\n    consumed: 1 + length,\n    result: result\n  };\n} // returns { consumed: number, result: Object }\n\n\nfunction _decode(data, offset) {\n  if (data.length === 0) {\n    throw new Error('invalid rlp data');\n  } // Array with extra length prefix\n\n\n  if (data[offset] >= 0xf8) {\n    var lengthLength = data[offset] - 0xf7;\n\n    if (offset + 1 + lengthLength > data.length) {\n      throw new Error('too short');\n    }\n\n    var length_2 = unarrayifyInteger(data, offset + 1, lengthLength);\n\n    if (offset + 1 + lengthLength + length_2 > data.length) {\n      throw new Error('to short');\n    }\n\n    return _decodeChildren(data, offset, offset + 1 + lengthLength, lengthLength + length_2);\n  } else if (data[offset] >= 0xc0) {\n    var length_3 = data[offset] - 0xc0;\n\n    if (offset + 1 + length_3 > data.length) {\n      throw new Error('invalid rlp data');\n    }\n\n    return _decodeChildren(data, offset, offset + 1, length_3);\n  } else if (data[offset] >= 0xb8) {\n    var lengthLength = data[offset] - 0xb7;\n\n    if (offset + 1 + lengthLength > data.length) {\n      throw new Error('invalid rlp data');\n    }\n\n    var length_4 = unarrayifyInteger(data, offset + 1, lengthLength);\n\n    if (offset + 1 + lengthLength + length_4 > data.length) {\n      throw new Error('invalid rlp data');\n    }\n\n    var result = bytes_1.hexlify(data.slice(offset + 1 + lengthLength, offset + 1 + lengthLength + length_4));\n    return {\n      consumed: 1 + lengthLength + length_4,\n      result: result\n    };\n  } else if (data[offset] >= 0x80) {\n    var length_5 = data[offset] - 0x80;\n\n    if (offset + 1 + length_5 > data.length) {\n      throw new Error('invlaid rlp data');\n    }\n\n    var result = bytes_1.hexlify(data.slice(offset + 1, offset + 1 + length_5));\n    return {\n      consumed: 1 + length_5,\n      result: result\n    };\n  }\n\n  return {\n    consumed: 1,\n    result: bytes_1.hexlify(data[offset])\n  };\n}\n\nfunction decode(data) {\n  var bytes = bytes_1.arrayify(data) || new Uint8Array();\n\n  var decoded = _decode(bytes, 0);\n\n  if (decoded.consumed !== bytes.length) {\n    throw new Error('invalid rlp data');\n  }\n\n  return decoded.result;\n}\n\nexports.decode = decode;","map":{"version":3,"mappings":"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","names":["arrayifyInteger","value","result","unshift","unarrayifyInteger","data","offset","length","i","_encode","object","Array","isArray","payload_1","forEach","child","concat","length_1","prototype","slice","call","bytes_1","encode","exports","_decodeChildren","childOffset","decoded","_decode","push","consumed","Error","lengthLength","length_2","length_3","length_4","length_5","decode","bytes","Uint8Array"],"sourceRoot":"","sources":["../src/rlp.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}