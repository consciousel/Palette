{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.validateBody = exports.httpDelete = exports.put = exports.postMultiForm = exports.post = exports.get = exports.axios = void 0;\n\nconst axios_1 = __importDefault(require(\"axios\"));\n\nconst axios_retry_1 = __importStar(require(\"axios-retry\"));\n\nconst class_transformer_1 = require(\"class-transformer\");\n\nconst class_validator_1 = require(\"class-validator\");\n\nconst http_1 = __importDefault(require(\"http\"));\n\nconst https_1 = __importDefault(require(\"https\"));\n\nconst constants_1 = require(\"../constants\");\n\nexports.axios = axios_1.default.create({\n  httpAgent: new http_1.default.Agent({\n    keepAlive: true\n  }),\n  httpsAgent: new https_1.default.Agent({\n    keepAlive: true\n  })\n}); // In case of 429 Too Many Requests response error, request is triggered again\n\naxios_retry_1.default(exports.axios, {\n  retryDelay: () => process.env.TATUM_RETRY_DELAY ? Number(process.env.TATUM_RETRY_DELAY) : constants_1.TATUM_RETRY_DELAY,\n  retries: process.env.TATUM_RETRIES ? Number(process.env.TATUM_RETRIES) : constants_1.TATUM_RETRIES,\n  retryCondition: error => {\n    var _a;\n\n    return axios_retry_1.isNetworkOrIdempotentRequestError(error) || ((_a = error === null || error === void 0 ? void 0 : error.response) === null || _a === void 0 ? void 0 : _a.status) === 429;\n  }\n});\n\nconst baseUrl = () => process.env.TATUM_API_URL || constants_1.TATUM_API_URL;\n\nconst headers = () => ({\n  headers: {\n    'x-api-key': process.env.TATUM_API_KEY,\n    'x-testnet-type': process.env.TESTNET_TYPE || 'ethereum-ropsten'\n  }\n});\n\nconst get = async url => {\n  const {\n    data\n  } = await exports.axios.get(`${baseUrl()}${url}`, headers());\n  return data;\n};\n\nexports.get = get; // eslint-disable-next-line @typescript-eslint/ban-types\n\nconst post = async (url, body, classType) => {\n  await exports.validateBody(body, classType);\n  const {\n    data\n  } = await exports.axios.post(`${baseUrl()}${url}`, body, headers());\n  return data;\n};\n\nexports.post = post; // eslint-disable-next-line @typescript-eslint/ban-types\n\nconst postMultiForm = async (url, body) => {\n  const h = headers();\n  h.headers = Object.assign(Object.assign({}, h.headers), body.getHeaders());\n  const {\n    data\n  } = await exports.axios.post(`${baseUrl()}${url}`, body, h);\n  return data;\n};\n\nexports.postMultiForm = postMultiForm; // eslint-disable-next-line @typescript-eslint/ban-types\n\nconst put = async (url, body, classType) => {\n  await exports.validateBody(body, classType);\n  const {\n    data\n  } = await exports.axios.put(`${baseUrl()}${url}`, body, headers());\n  return data;\n};\n\nexports.put = put;\n\nconst httpDelete = async url => {\n  await exports.axios.delete(`${baseUrl()}${url}`, headers());\n};\n\nexports.httpDelete = httpDelete; // eslint-disable-next-line @typescript-eslint/ban-types\n\nconst validateBody = async (body, classType) => {\n  if (classType) {\n    const classInstance = class_transformer_1.plainToClass(classType, body);\n    await class_validator_1.validateOrReject(classInstance);\n  }\n};\n\nexports.validateBody = validateBody;","map":{"version":3,"mappings":"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","names":["exports","axios_1","create","httpAgent","http_1","Agent","keepAlive","httpsAgent","https_1","axios_retry_1","retryDelay","process","env","TATUM_RETRY_DELAY","Number","constants_1","retries","TATUM_RETRIES","retryCondition","error","response","_a","status","baseUrl","TATUM_API_URL","headers","TATUM_API_KEY","TESTNET_TYPE","get","url","data","post","body","classType","postMultiForm","h","Object","getHeaders","put","httpDelete","delete","validateBody","classInstance","class_transformer_1","class_validator_1"],"sourceRoot":"","sources":["../../../src/connector/tatum.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}