{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst common_1 = require(\"../common\");\n\nconst utils_1 = require(\"./utils\");\n\nfunction formatBalanceSheet(balanceSheet) {\n  const result = {};\n\n  if (balanceSheet.balances != null) {\n    result.balances = [];\n    Object.entries(balanceSheet.balances).forEach(entry => {\n      const [counterparty, balances] = entry;\n      balances.forEach(balance => {\n        result.balances.push(Object.assign({\n          counterparty\n        }, balance));\n      });\n    });\n  }\n\n  if (balanceSheet.assets != null) {\n    result.assets = [];\n    Object.entries(balanceSheet.assets).forEach(_ref => {\n      let [counterparty, assets] = _ref;\n      assets.forEach(balance => {\n        result.assets.push(Object.assign({\n          counterparty\n        }, balance));\n      });\n    });\n  }\n\n  if (balanceSheet.obligations != null) {\n    result.obligations = Object.entries(balanceSheet.obligations).map(_ref2 => {\n      let [currency, value] = _ref2;\n      return {\n        currency,\n        value\n      };\n    });\n  }\n\n  return result;\n}\n\nfunction getBalanceSheet(address) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return __awaiter(this, void 0, void 0, function* () {\n    common_1.validate.getBalanceSheet({\n      address,\n      options\n    });\n    options = yield utils_1.ensureLedgerVersion.call(this, options);\n    const response = yield this.request('gateway_balances', {\n      account: address,\n      strict: true,\n      hotwallet: options.excludeAddresses,\n      ledger_index: options.ledgerVersion\n    });\n    return formatBalanceSheet(response);\n  });\n}\n\nexports.default = getBalanceSheet;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;;AAEA;;AA0BA,SAASA,kBAAT,CAA4BC,YAA5B,EAAsD;AACpD,QAAMC,MAAM,GAAoB,EAAhC;;AAEA,MAAID,YAAY,CAACE,QAAb,IAAyB,IAA7B,EAAmC;AACjCD,UAAM,CAACC,QAAP,GAAkB,EAAlB;AACAC,UAAM,CAACC,OAAP,CAAeJ,YAAY,CAACE,QAA5B,EAAsCG,OAAtC,CAA8CC,KAAK,IAAG;AACpD,YAAM,CAACC,YAAD,EAAeL,QAAf,IAA2BI,KAAjC;AACAJ,cAAQ,CAACG,OAAT,CAAkBG,OAAD,IAAY;AAC3BP,cAAM,CAACC,QAAP,CAAgBO,IAAhB,CAAqBN,MAAM,CAACO,MAAP,CAAc;AAACH;AAAD,SAAd,EAA8BC,OAA9B,CAArB;AACD,OAFD;AAGD,KALD;AAMD;;AACD,MAAIR,YAAY,CAACW,MAAb,IAAuB,IAA3B,EAAiC;AAC/BV,UAAM,CAACU,MAAP,GAAgB,EAAhB;AACAR,UAAM,CAACC,OAAP,CAAeJ,YAAY,CAACW,MAA5B,EAAoCN,OAApC,CAA4C,QAA2B;AAAA,UAA1B,CAACE,YAAD,EAAeI,MAAf,CAA0B;AACrEA,YAAM,CAACN,OAAP,CAAgBG,OAAD,IAAY;AACzBP,cAAM,CAACU,MAAP,CAAcF,IAAd,CAAmBN,MAAM,CAACO,MAAP,CAAc;AAACH;AAAD,SAAd,EAA8BC,OAA9B,CAAnB;AACD,OAFD;AAGD,KAJD;AAKD;;AACD,MAAIR,YAAY,CAACY,WAAb,IAA4B,IAAhC,EAAsC;AACpCX,UAAM,CAACW,WAAP,GAAqBT,MAAM,CAACC,OAAP,CAAeJ,YAAY,CAACY,WAA5B,EAAoEC,GAApE,CACnB;AAAA,UAAC,CAACC,QAAD,EAAWC,KAAX,CAAD;AAAA,aAAwB;AAACD,gBAAD;AAAWC;AAAX,OAAxB;AAAA,KADmB,CAArB;AAGD;;AAED,SAAOd,MAAP;AACD;;AAED,SAAee,eAAf,CAEEC,OAFF,EAGmC;AAAA,MAAjCC,OAAiC,uEAAF,EAAE;;AAGjCC,sBAASH,eAAT,CAAyB;AAACC,aAAD;AAAUC;AAAV,KAAzB;AACAA,WAAO,GAAG,MAAME,4BAAoBC,IAApB,CAAyB,IAAzB,EAA+BH,OAA/B,CAAhB;AAEA,UAAMI,QAAQ,GAAG,MAAM,KAAKC,OAAL,CAAa,kBAAb,EAAiC;AACtDC,aAAO,EAAEP,OAD6C;AAEtDQ,YAAM,EAAE,IAF8C;AAGtDC,eAAS,EAAER,OAAO,CAACS,gBAHmC;AAItDC,kBAAY,EAAEV,OAAO,CAACW;AAJgC,KAAjC,CAAvB;AAOA,WAAO9B,kBAAkB,CAACuB,QAAD,CAAzB;AACD;AAAA;;AAEDQ,kBAAed,eAAf","names":["formatBalanceSheet","balanceSheet","result","balances","Object","entries","forEach","entry","counterparty","balance","push","assign","assets","obligations","map","currency","value","getBalanceSheet","address","options","common_1","utils_1","call","response","request","account","strict","hotwallet","excludeAddresses","ledger_index","ledgerVersion","exports"],"sourceRoot":"","sources":["../../../src/ledger/balance-sheet.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}