{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.helperPrepareSCCall = exports.helperGetWeb3Client = exports.helperBroadcastTx = void 0;\n\nconst blockchain_1 = require(\"../blockchain\");\n\nconst marketplace_1 = require(\"../contracts/marketplace\");\n\nconst model_1 = require(\"../model\");\n\nconst transaction_1 = require(\"../transaction\");\n\nconst helperBroadcastTx = async (chain, txData, signatureId) => {\n  switch (chain) {\n    case model_1.Currency.CELO:\n      return await blockchain_1.celoBroadcast(txData, signatureId);\n\n    case model_1.Currency.ONE:\n      return await blockchain_1.oneBroadcast(txData, signatureId);\n\n    case model_1.Currency.ETH:\n      return await blockchain_1.ethBroadcast(txData, signatureId);\n\n    case model_1.Currency.BSC:\n      return await blockchain_1.bscBroadcast(txData, signatureId);\n\n    case model_1.Currency.MATIC:\n      return await blockchain_1.polygonBroadcast(txData, signatureId);\n\n    case model_1.Currency.KLAY:\n      return await blockchain_1.klaytnBroadcast(txData, signatureId);\n\n    case model_1.Currency.TRON:\n      return await blockchain_1.tronBroadcast(txData, signatureId);\n\n    default:\n      throw new Error('Unsupported chain');\n  }\n};\n\nexports.helperBroadcastTx = helperBroadcastTx;\n\nconst helperGetWeb3Client = (testnet, chain, provider) => {\n  switch (chain) {\n    case model_1.Currency.CELO:\n      return transaction_1.getCeloClient(provider);\n\n    case model_1.Currency.ONE:\n      return transaction_1.prepareOneClient(testnet, provider);\n\n    case model_1.Currency.XDC:\n      return transaction_1.getXdcClient(provider);\n\n    case model_1.Currency.ETH:\n      return transaction_1.getClient(provider);\n\n    case model_1.Currency.BSC:\n      return transaction_1.getBscClient(provider);\n\n    case model_1.Currency.MATIC:\n      return transaction_1.preparePolygonClient(testnet, provider);\n\n    case model_1.Currency.KLAY:\n      return transaction_1.prepareKlaytnClient(testnet, provider);\n\n    default:\n      throw new Error('Unsupported chain');\n  }\n};\n\nexports.helperGetWeb3Client = helperGetWeb3Client; // eslint-disable-next-line @typescript-eslint/ban-types\n\nconst helperPrepareSCCall = async function (testnet, body, clazz, methodName, params, methodSig, provider) {\n  let abi = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : marketplace_1.listing.abi;\n  let r;\n\n  if (body.chain === model_1.Currency.CELO) {\n    r = new model_1.CeloSmartContractMethodInvocation();\n  } else {\n    r = new model_1.SmartContractMethodInvocation();\n  }\n\n  r.fee = body.fee;\n  r.nonce = body.nonce;\n  r.fromPrivateKey = body.fromPrivateKey;\n  r.signatureId = body.signatureId;\n  r.index = body.index;\n  r.amount = body.amount;\n  r.contractAddress = body.contractAddress;\n  r.methodName = methodName;\n  r.params = params;\n  r.methodABI = abi.find(a => a.name === r.methodName);\n\n  switch (body.chain) {\n    case model_1.Currency.CELO:\n      return await transaction_1.prepareCeloSmartContractWriteMethodInvocation(testnet, Object.assign(Object.assign({}, r), {\n        feeCurrency: body.feeCurrency || model_1.Currency.CELO\n      }), provider);\n\n    case model_1.Currency.ONE:\n      return await transaction_1.prepareOneSmartContractWriteMethodInvocation(testnet, r, provider);\n\n    case model_1.Currency.XDC:\n      return await transaction_1.prepareXdcSmartContractWriteMethodInvocation(r, provider);\n\n    case model_1.Currency.ETH:\n      return await transaction_1.prepareSmartContractWriteMethodInvocation(r, provider);\n\n    case model_1.Currency.BSC:\n      return await transaction_1.prepareBscSmartContractWriteMethodInvocation(r, provider);\n\n    case model_1.Currency.MATIC:\n      return await transaction_1.preparePolygonSmartContractWriteMethodInvocation(testnet, r, provider);\n\n    case model_1.Currency.KLAY:\n      return await transaction_1.prepareKlaytnSmartContractWriteMethodInvocation(testnet, r, provider);\n\n    case model_1.Currency.TRON:\n      r.methodName = methodSig;\n      return await transaction_1.prepareTronSmartContractInvocation(testnet, r, body.feeLimit, body.from, provider);\n\n    default:\n      throw new Error('Unsupported combination of inputs.');\n  }\n};\n\nexports.helperPrepareSCCall = helperPrepareSCCall;","map":{"version":3,"mappings":"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","names":["helperBroadcastTx","chain","txData","signatureId","model_1","CELO","blockchain_1","ONE","ETH","BSC","MATIC","KLAY","TRON","Error","exports","helperGetWeb3Client","testnet","provider","transaction_1","XDC","helperPrepareSCCall","body","clazz","methodName","params","methodSig","abi","marketplace_1","r","fee","nonce","fromPrivateKey","index","amount","contractAddress","methodABI","find","a","name","Object","feeCurrency","feeLimit","from"],"sourceRoot":"","sources":["../../../src/helpers/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}