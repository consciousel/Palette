{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst utils = __importStar(require(\"./utils\"));\n\nconst ValidationError = utils.common.errors.ValidationError;\nconst claimFlags = utils.common.txFlags.PaymentChannelClaim;\n\nconst common_1 = require(\"../common\");\n\nfunction createPaymentChannelClaimTransaction(account, claim) {\n  const txJSON = {\n    Account: account,\n    TransactionType: 'PaymentChannelClaim',\n    Channel: claim.channel,\n    Flags: 0\n  };\n\n  if (claim.balance != null) {\n    txJSON.Balance = common_1.xrpToDrops(claim.balance);\n  }\n\n  if (claim.amount != null) {\n    txJSON.Amount = common_1.xrpToDrops(claim.amount);\n  }\n\n  if (Boolean(claim.signature) !== Boolean(claim.publicKey)) {\n    throw new ValidationError('\"signature\" and \"publicKey\" fields on' + ' PaymentChannelClaim must only be specified together.');\n  }\n\n  if (claim.signature != null) {\n    txJSON.Signature = claim.signature;\n  }\n\n  if (claim.publicKey != null) {\n    txJSON.PublicKey = claim.publicKey;\n  }\n\n  if (claim.renew === true && claim.close === true) {\n    throw new ValidationError('\"renew\" and \"close\" flags on PaymentChannelClaim' + ' are mutually exclusive');\n  }\n\n  if (claim.renew === true) {\n    txJSON.Flags |= claimFlags.Renew;\n  }\n\n  if (claim.close === true) {\n    txJSON.Flags |= claimFlags.Close;\n  }\n\n  return txJSON;\n}\n\nfunction preparePaymentChannelClaim(address, paymentChannelClaim) {\n  let instructions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  try {\n    common_1.validate.preparePaymentChannelClaim({\n      address,\n      paymentChannelClaim,\n      instructions\n    });\n    const txJSON = createPaymentChannelClaimTransaction(address, paymentChannelClaim);\n    return utils.prepareTransaction(txJSON, this, instructions);\n  } catch (e) {\n    return Promise.reject(e);\n  }\n}\n\nexports.default = preparePaymentChannelClaim;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA,MAAMA,eAAe,GAAGC,KAAK,CAACC,MAAN,CAAaC,MAAb,CAAoBH,eAA5C;AACA,MAAMI,UAAU,GAAGH,KAAK,CAACC,MAAN,CAAaG,OAAb,CAAqBC,mBAAxC;;AACA;;AAcA,SAASC,oCAAT,CACEC,OADF,EAEEC,KAFF,EAE4B;AAE1B,QAAMC,MAAM,GAAoB;AAC9BC,WAAO,EAAEH,OADqB;AAE9BI,mBAAe,EAAE,qBAFa;AAG9BC,WAAO,EAAEJ,KAAK,CAACK,OAHe;AAI9BC,SAAK,EAAE;AAJuB,GAAhC;;AAOA,MAAIN,KAAK,CAACO,OAAN,IAAiB,IAArB,EAA2B;AACzBN,UAAM,CAACO,OAAP,GAAiBC,oBAAWT,KAAK,CAACO,OAAjB,CAAjB;AACD;;AACD,MAAIP,KAAK,CAACU,MAAN,IAAgB,IAApB,EAA0B;AACxBT,UAAM,CAACU,MAAP,GAAgBF,oBAAWT,KAAK,CAACU,MAAjB,CAAhB;AACD;;AAED,MAAIE,OAAO,CAACZ,KAAK,CAACa,SAAP,CAAP,KAA6BD,OAAO,CAACZ,KAAK,CAACc,SAAP,CAAxC,EAA2D;AACzD,UAAM,IAAIvB,eAAJ,CACJ,0CACE,uDAFE,CAAN;AAID;;AAED,MAAIS,KAAK,CAACa,SAAN,IAAmB,IAAvB,EAA6B;AAC3BZ,UAAM,CAACc,SAAP,GAAmBf,KAAK,CAACa,SAAzB;AACD;;AACD,MAAIb,KAAK,CAACc,SAAN,IAAmB,IAAvB,EAA6B;AAC3Bb,UAAM,CAACe,SAAP,GAAmBhB,KAAK,CAACc,SAAzB;AACD;;AAED,MAAId,KAAK,CAACiB,KAAN,KAAgB,IAAhB,IAAwBjB,KAAK,CAACkB,KAAN,KAAgB,IAA5C,EAAkD;AAChD,UAAM,IAAI3B,eAAJ,CACJ,qDACE,yBAFE,CAAN;AAID;;AAED,MAAIS,KAAK,CAACiB,KAAN,KAAgB,IAApB,EAA0B;AACxBhB,UAAM,CAACK,KAAP,IAAgBX,UAAU,CAACwB,KAA3B;AACD;;AACD,MAAInB,KAAK,CAACkB,KAAN,KAAgB,IAApB,EAA0B;AACxBjB,UAAM,CAACK,KAAP,IAAgBX,UAAU,CAACyB,KAA3B;AACD;;AAED,SAAOnB,MAAP;AACD;;AAED,SAASoB,0BAAT,CAEEC,OAFF,EAGEC,mBAHF,EAIiC;AAAA,MAA/BC,YAA+B,uEAAF,EAAE;;AAE/B,MAAI;AACFf,sBAASY,0BAAT,CAAoC;AAClCC,aADkC;AAElCC,yBAFkC;AAGlCC;AAHkC,KAApC;AAKA,UAAMvB,MAAM,GAAGH,oCAAoC,CACjDwB,OADiD,EAEjDC,mBAFiD,CAAnD;AAIA,WAAO/B,KAAK,CAACiC,kBAAN,CAAyBxB,MAAzB,EAAiC,IAAjC,EAAuCuB,YAAvC,CAAP;AACD,GAXD,CAWE,OAAOE,CAAP,EAAU;AACV,WAAOC,OAAO,CAACC,MAAR,CAAeF,CAAf,CAAP;AACD;AACF;;AAEDG,kBAAeR,0BAAf","names":["ValidationError","utils","common","errors","claimFlags","txFlags","PaymentChannelClaim","createPaymentChannelClaimTransaction","account","claim","txJSON","Account","TransactionType","Channel","channel","Flags","balance","Balance","common_1","amount","Amount","Boolean","signature","publicKey","Signature","PublicKey","renew","close","Renew","Close","preparePaymentChannelClaim","address","paymentChannelClaim","instructions","prepareTransaction","e","Promise","reject","exports"],"sourceRoot":"","sources":["../../../src/transaction/payment-channel-claim.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}